# Our Wallet - é–‹ç™ºè€…ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰

æ–°è¦å‚ç”»ã®é–‹ç™ºè€…å‘ã‘ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‹ã‚‰é–‹ç™ºé–‹å§‹ã¾ã§ã®æ‰‹é †ã‚’ã¾ã¨ã‚ãŸã‚¬ã‚¤ãƒ‰ã§ã™ã€‚

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**Our Wallet** ã¯ã€å€‹äººãŠã‚ˆã³ã‚°ãƒ«ãƒ¼ãƒ—ã§ã®å®¶è¨ˆç®¡ç†ãƒ»äºˆç®—è¿½è·¡ã‚’è¡Œã†Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

### ä¸»è¦æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| æ”¯å‡ºè¨˜éŒ² | æ—¥ä»˜ãƒ»é‡‘é¡ãƒ»ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ»å†…å®¹ã‚’å…¥åŠ›ã—ã¦æ”¯å‡ºã‚’è¨˜éŒ² |
| ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥é›†è¨ˆ | é£Ÿè²»ã€ä½å±…è²»ã€å…‰ç†±è²»ã€æ—¥ç”¨å“ãªã©7ã‚«ãƒ†ã‚´ãƒªãƒ¼ã§åˆ†é¡ |
| æœˆåˆ¥ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ | æœˆã”ã¨ã®æ”¯å‡ºä¸€è¦§ãƒ»é›†è¨ˆã‚’è¡¨ç¤º |
| ã‚°ãƒ«ãƒ¼ãƒ—å…±æœ‰ | æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã§ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã—ã€è¤‡æ•°äººã§å®¶è¨ˆã‚’å…±æœ‰ |
| æ±ºç®—æ©Ÿèƒ½ | ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼é–“ã®ç²¾ç®—é‡‘é¡ã‚’è¨ˆç®— |

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Next.js 16 (App Router)
- **è¨€èª**: TypeScript
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL (æœ¬ç•ª: Neon, ãƒ­ãƒ¼ã‚«ãƒ«: Docker)
- **ORM**: Prisma 7
- **èªè¨¼**: Clerk
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS 4
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: Vercel

---

## 2. å¿…é ˆãƒ„ãƒ¼ãƒ«

é–‹ç™ºã‚’å§‹ã‚ã‚‹å‰ã«ã€ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚

| ãƒ„ãƒ¼ãƒ« | æ¨å¥¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç¢ºèªã‚³ãƒãƒ³ãƒ‰ |
|--------|---------------|-------------|
| Node.js | 20.x ä»¥ä¸Š | `node -v` |
| npm | 10.x ä»¥ä¸Š | `npm -v` |
| Git | 2.x ä»¥ä¸Š | `git --version` |
| Docker | æœ€æ–°ç‰ˆ | `docker --version` |
| Docker Compose | æœ€æ–°ç‰ˆï¼ˆDocker ã«åŒæ¢±ï¼‰ | `docker compose version` |

> **ğŸ’¡ ãƒ’ãƒ³ãƒˆ**: Node.js ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã«ã¯ [nvm](https://github.com/nvm-sh/nvm) ã‚„ [volta](https://volta.sh/) ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

---

## 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¾ã™ã€‚

```bash
# .env.example ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ .env ã‚’ä½œæˆ
cp .env.example .env
```

### å¿…è¦ãªç’°å¢ƒå¤‰æ•°ä¸€è¦§

| å¤‰æ•°å | èª¬æ˜ | å–å¾—å…ˆ |
|--------|------|--------|
| `DATABASE_URL` | PostgreSQLæ¥ç¶šæ–‡å­—åˆ— | ãƒ­ãƒ¼ã‚«ãƒ«: ä¸‹è¨˜å‚ç…§ / æœ¬ç•ª: Neonã‚³ãƒ³ã‚½ãƒ¼ãƒ« |
| `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` | Clerkå…¬é–‹ã‚­ãƒ¼ | [Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰](https://dashboard.clerk.com/) â†’ API Keys |
| `CLERK_SECRET_KEY` | Clerkã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ | åŒä¸Š |
| `NEXT_PUBLIC_CLERK_SIGN_IN_URL` | ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã®ãƒ‘ã‚¹ | å›ºå®šå€¤: `/sign-in` |
| `NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL` | ã‚µã‚¤ãƒ³ã‚¤ãƒ³å¾Œã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆ | å›ºå®šå€¤: `/` |
| `NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL` | ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—å¾Œã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆ | å›ºå®šå€¤: `/` |

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ã® `.env` ã‚µãƒ³ãƒ—ãƒ«

```env
# Database (Docker PostgreSQL)
DATABASE_URL="postgresql://user:password@localhost:5432/our_wallet_db?schema=public"

# Clerk Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxx
CLERK_SECRET_KEY=sk_test_xxxxx
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL=/
NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL=/
```

> **âš ï¸ é‡è¦**: `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ **çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„**ã€‚`.gitignore` ã«å«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

---

## 4. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### Step 1: ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/your-org/our-wallet-log-demo.git
cd our-wallet-log-demo
```

### Step 2: ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
```

### Step 3: ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

ä¸Šè¨˜ã€Œç’°å¢ƒå¤‰æ•°ã®è¨­å®šã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ã—ã€`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

### Step 4: PostgreSQLã®èµ·å‹•ï¼ˆDockerï¼‰

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•
docker compose up -d

# èµ·å‹•ç¢ºèª
docker compose ps
```

ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã§ã™ï¼š

```
NAME                  STATUS    PORTS
our-wallet-postgres   running   0.0.0.0:5432->5432/tcp
```

### Step 5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
npx prisma migrate dev

# Prisma Clientã‚’ç”Ÿæˆï¼ˆé€šå¸¸ã¯è‡ªå‹•ã§å®Ÿè¡Œã•ã‚Œã¾ã™ï¼‰
npx prisma generate
```

### Step 6: é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:3000 ã‚’é–‹ãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã§ã™ã€‚

---

## 5. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
our-wallet-log-demo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ layout.tsx          # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚   â”œâ”€â”€ page.tsx            # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ personal/           # å€‹äººæ”¯å‡ºãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ group/              # ã‚°ãƒ«ãƒ¼ãƒ—æ”¯å‡ºãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ settings/           # è¨­å®šãƒšãƒ¼ã‚¸
â”‚   â”‚   â””â”€â”€ sign-in/            # Clerkèªè¨¼ãƒšãƒ¼ã‚¸
â”‚   â”‚
â”‚   â”œâ”€â”€ backend/                # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ actions/            # Server Actionsï¼ˆCRUDæ“ä½œï¼‰
â”‚   â”‚   â”œâ”€â”€ auth/               # èªè¨¼ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ db.ts               # Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
â”‚   â”‚   â””â”€â”€ services/           # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚
â”‚   â”œâ”€â”€ components/             # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ui/                 # æ±ç”¨UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ expense/            # æ”¯å‡ºé–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ settings/           # è¨­å®šé–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                  # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ lib/                    # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ context/                # Reactã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â”‚   â””â”€â”€ types/                  # TypeScriptå‹å®šç¾©
â”‚
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma           # Prismaã‚¹ã‚­ãƒ¼ãƒ
â”‚   â””â”€â”€ migrations/             # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ prisma.config.ts            # Prismaè¨­å®šï¼ˆdatasource URLï¼‰
â”œâ”€â”€ docker-compose.yml          # PostgreSQLã‚³ãƒ³ãƒ†ãƒŠè¨­å®š
â””â”€â”€ package.json
```

### é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|----------|------|
| `src/backend/db.ts` | Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³åˆæœŸåŒ– |
| `src/backend/actions/expenses.ts` | æ”¯å‡ºã®CRUD Server Actions |
| `src/components/expense/ExpenseForm.tsx` | æ”¯å‡ºå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆreact-hook-form + zodï¼‰ |
| `prisma/schema.prisma` | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå®šç¾© |
| `prisma.config.ts` | Prisma 7ã®datasourceè¨­å®š |

---

## 6. ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# PostgreSQLèµ·å‹•/åœæ­¢
docker compose up -d
docker compose down

# Prismaã‚¹ã‚¿ã‚¸ã‚ªï¼ˆDBãƒ–ãƒ©ã‚¦ã‚¶ï¼‰
npx prisma studio

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚»ãƒƒãƒˆ
npx prisma migrate reset

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆãƒ»é©ç”¨
npx prisma migrate dev --name <migration_name>

# ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã‚’DBã«åæ˜ ï¼ˆé–‹ç™ºæ™‚ã®ã¿ï¼‰
npx prisma db push

# Prisma Clientå†ç”Ÿæˆ
npx prisma generate

# å‹ãƒã‚§ãƒƒã‚¯
npx tsc --noEmit

# ãƒªãƒ³ãƒˆ
npm run lint
```

---

## 7. ã‚ˆãã‚ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `Can't reach database server` ã‚„ `Connection refused`

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:

1. Dockerã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
   ```bash
   docker compose ps
   ```

2. `.env` ã® `DATABASE_URL` ãŒæ­£ã—ã„ã‹ç¢ºèª
   ```
   DATABASE_URL="postgresql://user:password@localhost:5432/our_wallet_db?schema=public"
   ```

3. ãƒãƒ¼ãƒˆ5432ãŒä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã§ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
   ```bash
   lsof -i :5432
   ```

### Clerkèªè¨¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `ClerkInstanceContext not found` ã‚„ `Invalid API Key`

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:

1. `.env` ã« `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` ã¨ `CLERK_SECRET_KEY` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹
2. ã‚­ãƒ¼ãŒæ­£ã—ãã‚³ãƒ”ãƒ¼ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆå‰å¾Œã®ç©ºç™½ã«æ³¨æ„ï¼‰
3. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•ã™ã‚‹ï¼ˆç’°å¢ƒå¤‰æ•°ã®å¤‰æ›´ã¯å†èµ·å‹•ãŒå¿…è¦ï¼‰

### Prismaé–¢é€£ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `PrismaClientInitializationError` ã‚„ `Schema validation error`

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:

1. Prisma Clientã‚’å†ç”Ÿæˆ
   ```bash
   npx prisma generate
   ```

2. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†é©ç”¨
   ```bash
   npx prisma migrate dev
   ```

3. DBã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã¾ã™ï¼‰
   ```bash
   npx prisma migrate reset
   ```

### ãƒãƒ¼ãƒˆãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹

**ç—‡çŠ¶**: `Port 3000 is in use` ã‚„ `Port 5432 is in use`

**è§£æ±ºæ–¹æ³•**:

```bash
# ä½¿ç”¨ä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºèª
lsof -i :3000
lsof -i :5432

# ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
kill -9 <PID>
```

---

## 8. å‚è€ƒãƒªãƒ³ã‚¯

- [Next.js Documentation](https://nextjs.org/docs)
- [Prisma Documentation](https://www.prisma.io/docs)
- [Clerk Documentation](https://clerk.com/docs)
- [Neon Documentation](https://neon.tech/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)

---

## 9. å›°ã£ãŸã¨ãã¯

1. **ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**ã‚’å†ç¢ºèª
2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ä»–ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**ã‚’å‚ç…§
   - `ARCHITECTURE.md` - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°
   - `DEPLOYMENT.md` - ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
   - `ENVIRONMENT_GUIDE.md` - ç’°å¢ƒè¨­å®šã®è©³ç´°
3. **ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã«è³ªå•**

---

Happy Coding! ğŸ‰
